quit -sim

if ![info exists QUARTUS_INSTALL_DIR] {
  set QUARTUS_INSTALL_DIR "C:/intelFPGA/17.1/quartus"
}

if ![info exists PRJ_DIR] {
  set PRJ_DIR "c:/Users/hudyakovas/Desktop/Khudyakov/MyProjects/RLCBC_BROD"
}

global QUARTUS_INSTALL_DIR
global PRJ_DIR

cd "$PRJ_DIR/sim"
vlib work
vmap work work

vlog ../tb/ethernet_64_bit_serial_for_axi/test_top.v

vlog ../tb/ethernet_64_bit_serial_for_axi/tb_ethernet_top.v

vlog ../tb/ethernet_64_bit_serial_for_axi/tb_ethernet_fake_transmitter.v

vlog ../tb/ethernet_64_bit_serial_for_axi/ethernet_receiver_lib/tb_ethernet_receiver.v
vlog ../tb/ethernet_64_bit_serial_for_axi/ethernet_receiver_lib/tb_ethernet_header_receiver.v
vlog ../tb/ethernet_64_bit_serial_for_axi/tb_ethernet_icmp_checksum_counter.v
vlog ../tb/ethernet_64_bit_serial_for_axi/tb_ethernet_head_reply_builder.v

vsim -voptargs=+acc work.test_top

add wave -position insertpoint  \
sim:/test_top/tb_ethernet_top_inst/FPGA_MAC \
sim:/test_top/tb_ethernet_top_inst/FPGA_IP \
sim:/test_top/tb_ethernet_top_inst/i_clk \
sim:/test_top/tb_ethernet_top_inst/i_reset \
sim:/test_top/tb_ethernet_top_inst/rx_axis_tvalid \
sim:/test_top/tb_ethernet_top_inst/rx_axis_tdata \
sim:/test_top/tb_ethernet_top_inst/rx_axis_tlast \
sim:/test_top/tb_ethernet_top_inst/rx_axis_tkeep \
sim:/test_top/tb_ethernet_top_inst/arp_valid \
sim:/test_top/tb_ethernet_top_inst/icmp_valid \
sim:/test_top/tb_ethernet_top_inst/udp_valid \
sim:/test_top/tb_ethernet_top_inst/data_head \
sim:/test_top/tb_ethernet_top_inst/data_head_valid \
sim:/test_top/tb_ethernet_top_inst/data_head_frame_payload_valid \
sim:/test_top/tb_ethernet_top_inst/data_head_frame_payload \
sim:/test_top/tb_ethernet_top_inst/data_head_frame_payload_keep \
sim:/test_top/tb_ethernet_top_inst/icmp_crc_part1 \
sim:/test_top/tb_ethernet_top_inst/icmp_crc_part1_ready \
sim:/test_top/tb_ethernet_top_inst/data_head_reply \
sim:/test_top/tb_ethernet_top_inst/data_head_reply_ready \
sim:/test_top/tb_ethernet_top_inst/icmp_crc \
sim:/test_top/tb_ethernet_top_inst/icmp_ready
add wave -position insertpoint  \
sim:/test_top/tb_ethernet_top_inst/tb_ethernet_icmp_checksum_counter_inst/i_clk \
sim:/test_top/tb_ethernet_top_inst/tb_ethernet_icmp_checksum_counter_inst/i_reset \
sim:/test_top/tb_ethernet_top_inst/tb_ethernet_icmp_checksum_counter_inst/i_rx_axis_tdata \
sim:/test_top/tb_ethernet_top_inst/tb_ethernet_icmp_checksum_counter_inst/i_rx_axis_tlast \
sim:/test_top/tb_ethernet_top_inst/tb_ethernet_icmp_checksum_counter_inst/i_rx_axis_tkeep \
sim:/test_top/tb_ethernet_top_inst/tb_ethernet_icmp_checksum_counter_inst/i_icmp_valid \
sim:/test_top/tb_ethernet_top_inst/tb_ethernet_icmp_checksum_counter_inst/i_icmp_crc_part1 \
sim:/test_top/tb_ethernet_top_inst/tb_ethernet_icmp_checksum_counter_inst/i_icmp_crc_part1_ready \
sim:/test_top/tb_ethernet_top_inst/tb_ethernet_icmp_checksum_counter_inst/o_icmp_crc \
sim:/test_top/tb_ethernet_top_inst/tb_ethernet_icmp_checksum_counter_inst/o_icmp_ready \
sim:/test_top/tb_ethernet_top_inst/tb_ethernet_icmp_checksum_counter_inst/o_icmp_crc_r \
sim:/test_top/tb_ethernet_top_inst/tb_ethernet_icmp_checksum_counter_inst/rx_axis_tlast_suspend \
sim:/test_top/tb_ethernet_top_inst/tb_ethernet_icmp_checksum_counter_inst/enable

run -all