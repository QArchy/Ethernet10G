quit -sim

if ![info exists QUARTUS_INSTALL_DIR] {
  set QUARTUS_INSTALL_DIR "C:/intelFPGA/17.1/quartus"
}

if ![info exists PRJ_DIR] {
  set PRJ_DIR "c:/Users/hudyakovas/Desktop/Khudyakov/MyProjects/Ethernet10G"
}

global QUARTUS_INSTALL_DIR
global PRJ_DIR

cd "$PRJ_DIR/sim"
vlib work
vmap work work

vlog ../tb/ethernet/tb_ethernet_top.v

vlog ../tb/ethernet/ethernet_receiver_lib/tb_ethernet_receiver.v
vlog ../tb/ethernet/ethernet_receiver_lib/tb_ethernet_fake_data_transmitter_controller.v
vlog ../tb/ethernet/ethernet_receiver_lib/tb_ethernet_fake_data_transmitter.v
vlog ../tb/ethernet/ethernet_receiver_lib/tb_ethernet_header_receiver.v
vlog ../tb/ethernet/ethernet_receiver_lib/tb_preambule_validity.v
vlog ../tb/ethernet/ethernet_receiver_lib/tb_crc_icmp_calc.v
vlog ../tb/ethernet/ethernet_receiver_lib/tb_crc_arp_calc.v
vlog ../tb/ethernet/ethernet_receiver_lib/crc_calc.v

vlog ../tb/ethernet/ethernet_reply_builder_lib/tb_ethernet_reply_builder.v
vlog ../tb/ethernet/ethernet_reply_builder_lib/tb_ethernet_icmp_reply_builder.v
vlog ../tb/ethernet/ethernet_reply_builder_lib/tb_ethernet_arp_reply_builder.v
vlog ../tb/ethernet/ethernet_reply_builder_lib/tb_ethernet_udp_reply_builder.v

vlog ../tb/ethernet/ethernet_reply_transmitter_lib/tb_ethernet_reply_transmitter.v
vlog ../tb/ethernet/ethernet_reply_transmitter_lib/tb_ethernet_icmp_reply_transmitter.v
vlog ../tb/ethernet/ethernet_reply_transmitter_lib/tb_ethernet_arp_reply_transmitter.v
vlog ../tb/ethernet/ethernet_reply_transmitter_lib/tb_ethernet_udp_reply_transmitter.v

vsim -voptargs=+acc work.tb_ethernet_top

add wave -position insertpoint  \
sim:/tb_ethernet_top/DSCP \
sim:/tb_ethernet_top/DSCP_r \
sim:/tb_ethernet_top/DST_PORT \
sim:/tb_ethernet_top/DST_PORT_r \
sim:/tb_ethernet_top/ECN \
sim:/tb_ethernet_top/ECN_r \
sim:/tb_ethernet_top/HLEN \
sim:/tb_ethernet_top/HLEN_r \
sim:/tb_ethernet_top/HTYPE \
sim:/tb_ethernet_top/HTYPE_r \
sim:/tb_ethernet_top/IHL \
sim:/tb_ethernet_top/IHL_r \
sim:/tb_ethernet_top/IP_DST \
sim:/tb_ethernet_top/IP_DST_r \
sim:/tb_ethernet_top/IP_SRC \
sim:/tb_ethernet_top/IP_SRC_r \
sim:/tb_ethernet_top/MAC_DST \
sim:/tb_ethernet_top/MAC_DST_r \
sim:/tb_ethernet_top/MAC_SRC \
sim:/tb_ethernet_top/MAC_SRC_r \
sim:/tb_ethernet_top/OPER \
sim:/tb_ethernet_top/OPER_r \
sim:/tb_ethernet_top/PLEN \
sim:/tb_ethernet_top/PLEN_r \
sim:/tb_ethernet_top/PTYPE \
sim:/tb_ethernet_top/PTYPE_r \
sim:/tb_ethernet_top/SHA \
sim:/tb_ethernet_top/SHA_r \
sim:/tb_ethernet_top/SPA \
sim:/tb_ethernet_top/SPA_r \
sim:/tb_ethernet_top/SRC_PORT \
sim:/tb_ethernet_top/SRC_PORT_r \
sim:/tb_ethernet_top/THA \
sim:/tb_ethernet_top/THA_r \
sim:/tb_ethernet_top/TPA \
sim:/tb_ethernet_top/TPA_r \
sim:/tb_ethernet_top/arp_crc_out \
sim:/tb_ethernet_top/arp_crc_out_r \
sim:/tb_ethernet_top/arp_crc_ready \
sim:/tb_ethernet_top/arp_crc_ready_r \
sim:/tb_ethernet_top/arp_reply \
sim:/tb_ethernet_top/arp_reply_ready \
sim:/tb_ethernet_top/arp_valid \
sim:/tb_ethernet_top/arp_valid_r \
sim:/tb_ethernet_top/clk \
sim:/tb_ethernet_top/code \
sim:/tb_ethernet_top/code_r \
sim:/tb_ethernet_top/eth_tp \
sim:/tb_ethernet_top/eth_tp_r \
sim:/tb_ethernet_top/flags \
sim:/tb_ethernet_top/flags_r \
sim:/tb_ethernet_top/fragment_offset \
sim:/tb_ethernet_top/fragment_offset_r \
sim:/tb_ethernet_top/header_checksum \
sim:/tb_ethernet_top/header_checksum_r \
sim:/tb_ethernet_top/header_data \
sim:/tb_ethernet_top/header_data_r \
sim:/tb_ethernet_top/icmp_crc_out \
sim:/tb_ethernet_top/icmp_crc_out_r \
sim:/tb_ethernet_top/icmp_crc_ready \
sim:/tb_ethernet_top/icmp_crc_ready_r \
sim:/tb_ethernet_top/icmp_header_checksum \
sim:/tb_ethernet_top/icmp_header_checksum_r \
sim:/tb_ethernet_top/icmp_reply_head \
sim:/tb_ethernet_top/icmp_reply_payload \
sim:/tb_ethernet_top/icmp_reply_payload_size \
sim:/tb_ethernet_top/icmp_reply_ready \
sim:/tb_ethernet_top/icmp_valid \
sim:/tb_ethernet_top/icmp_valid_r \
sim:/tb_ethernet_top/identification \
sim:/tb_ethernet_top/identification_r \
sim:/tb_ethernet_top/length \
sim:/tb_ethernet_top/length_r \
sim:/tb_ethernet_top/payload_word \
sim:/tb_ethernet_top/payload_word_r \
sim:/tb_ethernet_top/protocol \
sim:/tb_ethernet_top/protocol_r \
sim:/tb_ethernet_top/reset \
sim:/tb_ethernet_top/tot_len \
sim:/tb_ethernet_top/tot_len_r \
sim:/tb_ethernet_top/ttl \
sim:/tb_ethernet_top/ttl_r \
sim:/tb_ethernet_top/type_of_message \
sim:/tb_ethernet_top/type_of_message_r \
sim:/tb_ethernet_top/udp_header_checksum \
sim:/tb_ethernet_top/udp_header_checksum_r \
sim:/tb_ethernet_top/udp_reply_head \
sim:/tb_ethernet_top/udp_reply_payload \
sim:/tb_ethernet_top/udp_reply_payload_size \
sim:/tb_ethernet_top/udp_reply_ready \
sim:/tb_ethernet_top/udp_valid \
sim:/tb_ethernet_top/udp_valid_r \
sim:/tb_ethernet_top/valid \
sim:/tb_ethernet_top/valid_negedge_counter \
sim:/tb_ethernet_top/valid_prev \
sim:/tb_ethernet_top/version \
sim:/tb_ethernet_top/version_r \
sim:/tb_ethernet_top/word

run -all